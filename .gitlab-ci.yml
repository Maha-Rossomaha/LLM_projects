stages:
  - deploy

sync_main_to_github:
  stage: deploy
  image: alpine:latest
  before_script:
    - apk add --no-cache git openssh
  script:
    - git config --global user.name "GitLab CI"
    - git config --global user.email "ci@example.com"
    - git clone --branch=main "$CI_REPOSITORY_URL" repo
    - cd repo
    - git remote add github "$GITHUB_URL"
    - git push --force github main
  only:
    - main