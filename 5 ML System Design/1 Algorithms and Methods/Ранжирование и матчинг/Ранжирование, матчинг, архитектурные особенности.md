---
Owner: IIvan Vashchenko
---
> [!important]
> - **Ранжирование** используется в различных областях и представляет собой отдельный класс задач машинного обучения, направленный на упорядочивание объектов по релевантности.
> - **Матчинг** тесно связан с ранжированием и используется для сопоставления объектов, таких как товары на маркетплейсе.
> - Для улучшения работы систем ранжирования и матчинга используются мультимодальные модели, алгоритмы поиска ближайших соседей и методы отбора кандидатов на ранжирование.
> - В задачах матчинга крайне важно минимизировать ложные срабатывания, используя классификатор на финальном этапе сопоставления.

# Задача ранжирования в машинном обучении

**Ранжирование** — это процесс упорядочивания набора объектов в соответствии с некоторой мерой, т.е. создание частично упорядоченного множества. Задачи ранжирования применяются в широком спектре областей: от выдачи поисковых систем до планирования траекторий беспилотных автомобилей.

> Множество считается частично упорядоченным, если указано, какие элементы следуют за какими (какие элементы больше каких). Важно, что не все пары элементов обязательно связаны друг с другом, они могут быть на одном уровне шкалы либо не соотноситься с другими элементами.

Пример задачи: есть некоторый запрос q, по которому часть документов упорядочена от лучшей релевантности к худшей, но не все документы обязательно попадут на эту шкалу.

**Learning to Rank** (обучение ранжированию) — это класс задач машинного обучения, заключающийся в нахождении модели, которая максимально приближает способ ранжирования в обучающей выборке к новым данным. Он может быть реализован как с учителем (supervised), так и с частичным привлечением учителя (semi-supervised).

- В обучении с учителем каждому документу присваивается оценка его релевантности к конкретному запросу.
- В semi-supervised обучении часто используется псевдолейблинг, когда модель обучается на размеченном наборе данных, затем предсказывает лейблы для большого корпуса неразмеченных данных, что помогает улучшить качество предсказаний.

## Почему ранжирование выделяется в отдельный класс задач

Ранжирование выделяется в отдельный класс задач, так как задачи классификации и регрессии, как правило, оперируют одним объектом в один момент времени, тогда как задача ранжирования решает проблему упорядочивания множества объектов относительно друг друга.

Пример: классификация определяет, какие документы релевантны запросу, но не упорядочивает их, а регрессия может предсказывать показатель, по которому затем можно ранжировать (например, CTR или время пребывания).

В ранжировании применяется мера релевантности, которая выражает степень соответствия между запросом и документом. Чем выше мера релевантности, тем выше в списке должен располагаться документ.

## Схематичное изображение системы ранжирования

Пример системы ранжирования: при поступлении запроса q система ищет в базе подходящие документы и формирует список, упорядоченный по релевантности. Этот список не обязательно включает все документы, и те, что явно нерелевантны, могут быть отсеяны.

![[image 18.png|image 18.png]]

---

  

# Матчинг

**Матчинг** — это процесс сопоставления объектов на основе меры схожести, где с одной стороны запросы, а с другой — документы. Матчинг широко используется для следующих задач:

- Ценообразование (например, сравнение цен конкурентов);
- Мониторинг промоакций;
- Планирование ассортимента;
- Мониторинг рынка;
- Реализация функционала маркетплейса;
- Оперативный поиск.

Пример: ритейлер хочет сопоставить товары из своей базы с аналогами конкурентов, чтобы принять решение о корректировке цен. База документов, которую компания имеет в своём распоряжении, редко меняется, а база запросов может меняться в зависимости от того, какой магазин рассматривается.

**Проблема матчинга** заключается в необходимости минимизировать количество ложных срабатываний, когда происходит сопоставление с неправильным товаром. Для этого в конец пайплайна матчинга добавляется классификатор, который определяет корректность сопоставления. В случае сомнений лучше не выдавать результат, чем выдать неправильный матч.

## SKU и мультимодальные модели

**SKU** (Stock Keeping Unit) — это идентификатор товарной позиции, который используется для отслеживания запасов. SKU может иметь множество вариантов (например, разные цвета телефона), но всегда относится к одной модели.

**Мультимодальные модели** — это модели, которые оперируют данными разной природы, такими как изображения товара, текстовая информация, и используют совместные представления для их обработки. Это важно для задач, связанных с сопоставлением товаров, где информация может быть неполной или содержать различные англицизмы, сокращения и опечатки.

## Архитектурные особенности пайплайна матчинга и ранжирования

В пайплайне ранжирования и матчинга используются разные подходы для повышения эффективности и точности:

- **Re-ranking** (реранжирование): вместо того чтобы строить модель, работающую со всеми документами, применяется модель первого уровня для отбора кандидатов на ранжирование, а затем модель второго уровня для более точного ранжирования.
- **Кандидатная модель**: на первом этапе простая модель оценивает релевантность всех документов и отбирает топ-k кандидатов для дальнейшего анализа.
- **Поиск ближайших соседей (kNN)**: используется для поиска похожих документов, но требует большого количества ресурсов и времени. В качестве альтернативы применяются алгоритмы приближённого поиска (ANN), которые обеспечивают компромисс между точностью и скоростью.

[[Data Science/Karpov/Ранжирование и матчинг/Ранжирование, матчинг, архитектурные особенности/Untitled]]