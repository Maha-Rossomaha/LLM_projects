# Детерминированные алгоритмы декодирования в LLM

Детерминированные стратегии генерации **не используют случайность** при выборе следующего токена. Они дают **воспроизводимый и предсказуемый результат**, что может быть полезно в тестировании, валидации или при строгих ограничениях на выход.

---

## 1. Greedy Decoding

**Принцип:** на каждом шаге выбирается токен с максимальной вероятностью (argmax).

- Формально: выбирается $\arg\max_{t} P(t \mid x)$ на каждом шаге.
- Эквивалентно `temperature=0`, `top_k=1`

**Плюсы:**

- Быстро
- Воспроизводимо
- Подходит для задач, где важна точность (например, код, инструкции)

**Минусы:**

- Не исследует другие возможные пути
- Склонен к зацикливанию или повтору в длинных сессиях

**Частота использования:**

- Часто используется в задачах, где важна стабильность и точность: автоматическое тестирование, кодогенерация, выбор канонического ответа

---

## 2. Beam Search

**Принцип:** поддерживается несколько лучших гипотез (beam), которые развиваются параллельно. На каждом шаге выбираются топ-$k$ гипотез, а затем они расширяются.

- beam\_width — количество одновременно поддерживаемых гипотез (типично от 2 до 10)
- В конце выбирается гипотеза с максимальной общей логвероятностью

**Плюсы:**

- Улучшает глобальную оптимальность по сравнению с greedy
- Часто даёт более гладкий и завершённый текст

**Минусы:**

- Многократно увеличивает вычисления (в k раз)
- Может вызывать деградацию разнообразия (все лучи сходятся к одному)
- Плохо масштабируется при длинных последовательностях

**Частота использования:**

- Реже в LLM-практике (в отличие от машинного перевода и seq2seq до LLM эпохи)
- Иногда используется при генерации с жёсткими ограничениями или структурированным выводом (например, SQL)

---

## Сравнение

| Метод       | Стохастичность | Качество          | Скорость    | Использование         |
| ----------- | -------------- | ----------------- | ----------- | --------------------- |
| Greedy      | Нет              | Среднее           | Быстро   | Код, шаблонные ответы |
| Beam Search | Нет              | Потенциально выше | Медленно | Структурные задачи    


## Выводы

- **Greedy** — хорош для стабильности и скорости, но часто хуже по качеству.
- **Beam search** — более точный, но тяжелый и редко используется с LLM.

