# Prompt-мутации для проверки стабильности ответа

## 1. Что это такое

Prompt-мутации — это целенаправленные изменения входного запроса (prompt’а) для проверки, насколько модель сохраняет смысл и точность ответа при различных формулировках или условиях.

---

## 2. Зачем нужны тесты с мутациями

* **Проверка стабильности**: ответ должен оставаться корректным и последовательным при изменении порядка слов, синонимов или незначительных деталей.
* **Выявление уязвимостей**: некоторые формулировки могут непреднамеренно влиять на поведение модели.
* **Оптимизация промптов**: понимание, какие изменения снижают или повышают качество.

---

## 3. Виды мутаций

* **Лексические**: замена слов синонимами, изменение регистра, орфографические ошибки.
* **Синтаксические**: перестановка слов, изменение порядка предложений.
* **Семантические**: изменение стиля, добавление уточнений или лишних деталей.
* **Контекстные**: добавление отвлекающей информации, изменение формата (список, абзац).

---

## 4. Методы тестирования

### 4.1 Автоматизированные

* Генерация мутаций с помощью NLP-инструментов (NL-Augmenter, TextAttack).
* Использование LLM для переформулировки запросов.

### 4.2 Ручные

* Экспертное составление изменённых вариантов prompt’ов.
* A/B-тестирование разных формулировок.

---

## 5. Метрики устойчивости

* **Consistency score** — доля совпадений ключевых фактов в ответах.
* **Semantic similarity** между оригинальным и мутированным ответом.
* **Answer drift rate** — частота значимых изменений ответа.

---

## 6. Применение

* Валидация систем поиска и RAG.
* Проверка стабильности чат-ботов в клиентской поддержке.
* Диагностика чувствительности к изменению пользовательских формулировок.

---

## 7. Как уменьшить проблемы от нестабильности ответов

* Fine-tuning на разнообразных формулировках одного запроса.
* Добавление инструкций о фокусе на фактах, а не на стиле запроса.
* Фильтрация и нормализация пользовательских запросов перед подачей в модель.
