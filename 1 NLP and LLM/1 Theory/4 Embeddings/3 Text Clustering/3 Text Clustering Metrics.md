## Метрики качества кластеризации

### Основные свойства: однородность и полнота

- **Однородность (homogeneity)** — все объекты в одном кластере принадлежат одному истинному классу.
- **Полнота (completeness)** — все объекты одного класса попали в один кластер.
- Часто между ними приходится балансировать, особенно при выборе числа кластеров или метода.

---

### Метрики при наличии истинных меток

#### Adjusted Rand Index (ARI)

- Основан на парных сравнениях объектов: учитывает TP, TN, FP, FN.
- Корректируется на случайное совпадение: 0 — случайное, 1 — идеально, <0 — хуже случайного.
- Строгая, симметричная, устойчивая к различию в размере кластеров.
- Рекомендуется при наличии разметки как самая информативная метрика.

#### Normalized Mutual Information (NMI)

- Измеряет взаимную информацию между предсказанными и истинными разметками, нормируя на энтропию.
- Значения от 0 до 1: чем выше, тем ближе структуры.
- Хорошо отражает степень общего перекрытия без учёта точных границ.
- Часто используется в научных публикациях.

#### V-Measure

- Гармоническое среднее между однородностью и полнотой.
- Удобна для быстрой оценки, но менее информативна, чем ARI.

#### Fowlkes-Mallows Index (FMI)

- Геометрическое среднее между precision и recall по парам объектов.
- Менее распространён, но легко интерпретируется.

---

### Метрики без разметки (внутренние)

#### Silhouette Score

- Измеряет, насколько объект ближе к своему кластеру, чем к ближайшему другому.
- Диапазон: от -1 (неправильно) до +1 (хорошо), около 0 — неопределённость.
- Удобен, но требует подсчёта расстояний между объектами.

#### Davies–Bouldin Index (DBI)

- Среднее отношение внутрикластерной дисперсии к межкластерному расстоянию.
- Меньше — лучше.

#### Calinski–Harabasz Index (CHI)

- Отношение межкластерной дисперсии к внутрикластерной.
- Больше — лучше.

#### Cohesion

- Внутрикластерная плотность: сумма расстояний до центра.
- Чем меньше, тем лучше.

---

### Рекомендации по метрикам (на практике)

1. **ARI** — наиболее строгая и надёжная метрика, но требует, чтобы количество истинных классов и кластеров было сопоставимо.

2. **NMI, FMI, V-Measure** — чувствительны к разбалансировке, могут терять устойчивость при большом количестве малых кластеров.

3. **Silhouette** хорошо работает, если эмбеддинги дают адекватную геометрию кластеров (но зависит от метрики расстояния).

4. **Silhouette + NMI** — практичное и сбалансированное комбо. В реальности полную разметку можно получить хотя бы частично.

5. Для разных алгоритмов и целей могут подходить разные метрики → рекомендуется считать сразу несколько и сравнивать.
