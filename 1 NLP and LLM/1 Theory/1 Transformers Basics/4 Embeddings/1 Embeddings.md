## Embedding Layer

URL:  
üîó [Embedding layer tutorial: A comprehensive guide to neural network representations](https://www.byteplus.com/en/topic/400368)

## 1. –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Embedding Layer
- Embedding layer –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–ª–æ–≤–∞, –≤ –ø–ª–æ—Ç–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª—è–º –≤—ã—è–≤–ª—è—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.
- –ë–µ–∑ embedding –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å one-hot –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç–∏.

## 2. –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- Embedding layer —Ö—Ä–∞–Ω–∏—Ç —Ç–∞–±–ª–∏—Ü—É –≤–µ—Å–æ–≤ —Ñ–æ—Ä–º—ã `(vocab_size, embedding_dim)`, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –≤–µ–∫—Ç–æ—Ä —Ç–æ–∫–µ–Ω–∞.
- –ü—Ä–∏ –≤—ã–∑–æ–≤–µ —Å–ª–æ–π –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é look-up: –≤—ã–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –≤—Ö–æ–¥–Ω—ã–º –∏–Ω–¥–µ–∫—Å–∞–º, —Ñ–æ—Ä–º–∏—Ä—É—è –≤—ã—Ö–æ–¥–Ω—É—é —Ç–µ–Ω–∑–æ—Ä–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤.
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã embedding –æ–±—É—á–∞—é—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å –¥—Ä—É–≥–∏–º–∏ –≤–µ—Å–∞–º–∏ –º–æ–¥–µ–ª–∏ –º–µ—Ç–æ–¥–æ–º backpropagation.

## 3. –ü—Ä–∏–º–µ—Ä —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ PyTorch
```python
import torch
import torch.nn as nn

class CustomEmbedding(nn.Module):
    def __init__(self, vocab_size, embedding_dim):
        super().__init__()
        self.weight = nn.Parameter(torch.randn(vocab_size, embedding_dim))

    def forward(self, x):
        return self.weight[x]
```
- –ó–¥–µ—Å—å `self.weight` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è.
- –ú–µ—Ç–æ–¥ `forward` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—É—Ç–µ–º –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–Ω–∑–æ—Ä–∞ –≤–µ—Å–æ–≤ –ø–æ –≤—Ö–æ–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–∞–º.


